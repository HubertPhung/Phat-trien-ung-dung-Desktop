using System;
using System.Windows.Forms;
using WindowsFormsApp2.Security;

namespace WindowsFormsApp2
{
    public partial class frmMain : Form
    {
        public frmMain()
        {
            InitializeComponent();
            Load += FrmMain_Load;
        }
  
        private void FrmMain_Load(object sender, EventArgs e)
        {
            // Phân quyền UI theo Type (1: Admin, 0: Staff)
            bool isAdmin = UserContext.Type == 1;
            // Ví dụ: staff không thấy màn Tài khoản và Doanh thu
            try
            {
                var btnTaiKhoanVisibleProp = this.GetType().GetField("btnTaiKhoan", System.Reflection.BindingFlags.Instance | System.Reflection.BindingFlags.NonPublic | System.Reflection.BindingFlags.Public);
                var btnDoanhThuVisibleProp = this.GetType().GetField("btnDoanhThu", System.Reflection.BindingFlags.Instance | System.Reflection.BindingFlags.NonPublic | System.Reflection.BindingFlags.Public);
                if (btnTaiKhoanVisibleProp?.GetValue(this) is Control btnTaiKhoan)
                    btnTaiKhoan.Visible = isAdmin;
                if (btnDoanhThuVisibleProp?.GetValue(this) is Control btnDoanhThu)
                    btnDoanhThu.Visible = isAdmin;
            }
            catch { }
        }

        private void container(object _form)
        {
            if (pnHienThi.Controls.Count > 0) pnHienThi.Controls.Clear();

            Form fm = _form as Form;
            fm.TopLevel = false;
            fm.FormBorderStyle = FormBorderStyle.None;
            fm.Dock = DockStyle.Fill;
            pnHienThi.Controls.Add(fm);
            pnHienThi.Tag = fm;
            fm.Show();

        }

        private void btnHome_Click(object sender, EventArgs e)
        {
            container(new frmHome());
        }

        private void btnPhong_Click(object sender, EventArgs e)
        {
            container(new frmPhong());
        }

        private void btnDichVu_Click(object sender, EventArgs e)
        {
            container(new frmDichVu());
        }

        private void btnDoanhThu_Click(object sender, EventArgs e)
        {
            container(new frmDoanhThu());
        }

        private void btnKhachHang_Click(object sender, EventArgs e)
        {
            container(new frmKhachHang());
        }

        private void btnHoaDon_Click(object sender, EventArgs e)
        {
            container(new frmHoaDon());
        }

        private void btnTaiKhoan_Click(object sender, EventArgs e)
        {
            container(new frmTaiKhoan());
        }

        private void pictureBox1_Click(object sender, EventArgs e)
        {

        }
    }
}
